#!/bin/bash

ss="gnome-screenshot -a"
delay="gnome-screenshot -a -d 3" # =seconds

pwd > /tmp/mypath.txt
workingdir=$(head -n1 /tmp/mypath.txt)

if [ -z "$1" ]; then
  random_prefix_if_needed="$(isosec)"
else
  random_prefix_if_needed="$1"
fi

if [ "$1" == "delay" ]; then
  printname=$2
else
  printname="$random_prefix_if_needed"  # else the png gonna start with . and be hidden
fi

sspath="$workingdir/media/$printname.png"

if [ ! -d media ]; then
  mkdir media
fi

if [ "$1" == "delay" ]; then
  $delay -f "$sspath";
else
  $ss -f "$sspath"
fi

xclip -selection clipboard -t image/png < "$sspath"

mediapath=media/"$printname.png"

echo "![$printname]($mediapath)"
